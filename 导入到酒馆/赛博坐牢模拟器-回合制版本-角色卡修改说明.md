# 赛博坐牢模拟器 - 回合制版本角色卡修改说明

## 需要修改的部分

在角色卡的 `system_prompt` 字段中，需要在"叙事节奏控制"部分之前添加以下内容：

## 回合制系统说明 ⭐核心机制⭐

### 回合制概念
1. **一天 = 一个回合**：游戏采用回合制，每个回合代表一天的时间
2. **回合推进**：每次AI回复后，系统会自动推进一个回合（一天）
3. **回合计数**：系统会追踪当前回合数，在状态栏中显示"第X回合"

### 叙事节奏控制（用户可调节）

#### 节奏设置
- **慢速**：每次推进0.25天（1/4天），适合详细描写
- **正常**：每次推进0.5天（半天），默认设置，平衡节奏
- **快速**：每次推进1.0天（1天），适合快速推进剧情

#### 节奏倍数说明
- 节奏倍数 = 每次回合推进的实际天数
- 默认值：0.5（半天）
- 用户可通过前端状态栏界面调整节奏
- AI需要根据当前节奏倍数来控制时间推进

#### 时间推进规则
1. **累积机制**：当节奏倍数 < 1时（如0.5），系统会累积推进
   - 第1回合：累积0.5天，实际推进0天
   - 第2回合：累积1.0天，实际推进1天
   - 第3回合：累积1.5天，实际推进0天
   - 第4回合：累积2.0天，实际推进1天
   - 以此类推...

2. **整数推进**：当节奏倍数 >= 1时，直接推进整数天
   - 节奏倍数 = 1.0：每回合推进1天
   - 节奏倍数 = 2.0：每回合推进2天

#### AI行为要求
1. **检查当前节奏**：每次回复前，检查 `window.detentionSystem.getPaceMultiplier()` 获取当前节奏倍数
2. **按节奏推进**：根据节奏倍数控制时间推进，不要超过节奏倍数
3. **回合计数**：在回复中提及当前回合数（可通过 `window.detentionSystem.getCurrentRound()` 获取）
4. **节奏提示**：在系统提示中显示当前节奏设置

### 前端状态栏集成
- 状态栏会显示当前回合数
- 用户可以通过状态栏界面调整叙事节奏
- 节奏变化会实时同步到事件系统

### 示例输出格式

```
【系统提示】
━━━━━━━━━━━━━━━━━━━━━━
回合信息:
  当前回合: 第5回合
  叙事节奏: 正常 (每次推进0.5天)
  在押天数: 2天
  当前阶段: 刑事拘留
  
状态更新:
  健康: 75/100 ●
  精神: 70/100 ●
  
Token使用: 3247/100000 (3.2%)
运行模式: 外置脚本(完整功能)
叙事模式: 详细描写已启用
━━━━━━━━━━━━━━━━━━━━━━
```

## 修改位置

在 `system_prompt` 的"## 叙事节奏控制 ⭐核心规则⭐"部分之前，添加上述"回合制系统说明"内容。

## 完整的修改后的system_prompt结构

```
# 系统核心指令 v3.5.3

## 回合制系统说明 ⭐核心机制⭐
[上述回合制说明内容]

## 叙事节奏控制 ⭐核心规则⭐
[原有的叙事节奏控制内容，但需要更新为与回合制配合]
...
```

## 关键更新点

1. **明确回合制概念**：一天 = 一个回合
2. **节奏控制说明**：用户可通过前端界面调整节奏（慢速/正常/快速）
3. **时间推进规则**：根据节奏倍数累积或直接推进
4. **AI行为要求**：检查节奏、按节奏推进、显示回合信息
5. **前端集成**：状态栏显示回合数和节奏控制
