# 测试脚本使用说明

## 📋 测试脚本文件

我为你创建了三个测试脚本：

1. **`测试脚本.js`** - 完整测试脚本（详细检查所有功能，包含14项测试）
2. **`快速测试.js`** - 快速测试脚本（快速检查核心功能，约30行代码）
3. **`单行测试.js`** - 超简洁单行测试（一行代码，最快速检查）

## 🚀 使用方法

### 方法一：直接复制粘贴（推荐）

1. 打开浏览器，进入酒馆页面
2. 按 `F12` 打开开发者工具
3. 切换到 **Console（控制台）** 标签
4. 打开 `导入到酒馆/测试脚本.js` 或 `导入到酒馆/快速测试.js` 文件
5. **全选并复制**整个文件内容
6. 粘贴到控制台中，按 `Enter` 执行

### 方法二：使用函数调用

如果脚本已经加载，可以在控制台中直接输入：

```javascript
// 完整测试
testDetentionSystem()

// 或者快速测试
quickTest()
```

### 方法三：单行测试（最快）

直接复制 `单行测试.js` 文件中的一行代码到控制台即可，最快速检查核心功能。

## 📊 测试内容

### 完整测试脚本包含：

1. ✅ **核心系统检查**
   - window.detentionSystem 是否存在
   - 版本信息
   - 初始化状态

2. ✅ **模块检查**
   - 事件系统模块
   - 状态栏模块
   - NPC 系统模块
   - 知识库加载器模块

3. ✅ **功能测试**
   - 核心方法（ping, registerModule, getModule 等）
   - 事件系统方法（advanceDay, getCurrentStage 等）
   - 状态栏方法（getState）
   - Token 预算系统

4. ✅ **UI 检查**
   - 状态栏 UI 元素是否存在

5. ✅ **错误检查**
   - CORS 错误检测
   - 其他常见错误

### 快速测试脚本包含：

- 核心系统基本信息
- 已注册模块列表
- 关键功能可用性
- Ping 测试
- UI 状态

## 📝 测试结果说明

测试脚本会输出：

- ✅ **绿色对勾**：测试通过
- ❌ **红色叉号**：测试失败（需要修复）
- ⚠️ **黄色警告**：警告信息（可能正常，如模块尚未完全加载）

## 🔍 常见问题

### Q: 如果显示 "window.detentionSystem 未定义"？

**A:** 可能的原因：
1. 脚本尚未加载完成（等待几秒后重试）
2. 脚本导入失败（检查网络连接和脚本链接）
3. core.ts 模块加载失败（检查控制台错误信息）

### Q: 如果某些模块显示为"未注册"？

**A:** 这是正常的，因为：
- 模块可能还在初始化中（等待几秒后重试）
- 某些模块是可选加载的
- 检查控制台是否有错误信息

### Q: 如何多次运行测试？

**A:** 直接再次粘贴脚本或调用函数即可。测试脚本是幂等的，可以多次运行。

## 💡 提示

- 如果脚本刚加载，建议等待 2-3 秒后再运行测试
- 如果测试失败，检查浏览器控制台的错误信息
- 可以多次运行测试以验证系统状态变化
